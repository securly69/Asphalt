<!DOCTYPE html>
<html>
  <head>
    <title>MadEgg Browser</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Futura&family=IBM+Plex+Sans:wght@400;500&display=swap" rel="stylesheet" />
    <style>
      html { overflow: hidden; }
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font-family: 'IBM Plex Sans', sans-serif; background: #f0f0f0; height: 100vh; width: 100vw; display: flex; overflow: hidden; }
      #browser { background: white; width: 100vw; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
      #tabs-bar { display: flex; background: #f8f9fa; padding: 5px 10px 0; border-bottom: 1px solid #ddd; transition: all 0.3s ease; align-items: center; justify-content: space-between; }
      #tabs-container { display: flex; gap: 6px; overflow-x: auto; flex: 1; }
      .tab { display: flex; align-items: center; gap: 8px; padding: 7px 14px; background: #e9ecef; border: 1px solid #ddd; border-bottom: none; border-radius: 6px 6px 0 0; cursor: pointer; min-width: 119px; font-family: 'IBM Plex Sans', sans-serif; font-size: 13px; font-weight: 500; transition: background 0.3s ease, transform 0.3s ease; }
      .tab.active { background: white; }
      #toolbar { padding: 10px; background: #f8f9fa; border-bottom: 1px solid #ddd; display: flex; gap: 15px; align-items: center; justify-content: center; transition: all 0.3s ease; }
      #controls { display: flex; gap: 8px; }
      .control-btn { background: none; border: none; padding: 5px; cursor: pointer; border-radius: 4px; transition: transform 0.2s; }
      .control-btn:hover { transform: scale(1.1); }
      .control-btn i { color: #333; font-size: 15px; }
      #url-bar { flex: 1; display: flex; gap: 9px; align-items: center; justify-content: flex-start; font-weight: 500; width: 100%; }
      #url-input { flex: 1; padding: 9px 17px; border: 1px solid #ddd; border-radius: 25px; outline: none; font-size: 14px; font-family: 'IBM Plex Sans', sans-serif; text-align: center; font-weight: 500; }
      #content-container { flex: 1; position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center; }
      #newtab-content { width: 100%; height: 100%; background: url('https://cdn.dribbble.com/users/234525/screenshots/5853076/eggsacrosstheuniverse.jpg') no-repeat center center; background-size: cover; color: white; overflow: hidden; transform: none; transform-origin: center; transition: transform 0.3s ease; border: none; }
      #settings-page, #history-page { display: none; width: 100%; height: 100%; }
      #settings-page { background: #333; color: white; display: flex; align-items: center; justify-content: center; flex-direction: column; }
      #settings-page input { padding: 10px; margin: 5px; border: 1px solid #555; border-radius: 5px; }
      #settings-page button { padding: 10px 15px; margin-top: 10px; border: none; border-radius: 5px; background: #5192f5; color: white; cursor: pointer; }
      #history-page { background: #222; color: white; padding: 20px; overflow-y: auto; }
      #history-page h2 { margin-bottom: 20px; }
      .history-list { list-style: none; font-size: 16px; padding: 0; margin: 0; }
      .history-list li { margin: 10px 0; cursor: pointer; color: #fff; }
      #browserContainer { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
      #content { display: flex; flex-direction: column; align-items: center; text-align: center; width: 100%; max-width: 800px; }
      h1, .time-date, .bookmark span, .add-bookmark { font-family: 'Futura', sans-serif; }
      .bookmarks { display: flex; justify-content: center; gap: 17px; flex-wrap: wrap; opacity: 0; animation: enterBookmarks 1s forwards 0.5s; margin-top: 13px !important; }
      .add-bookmark { display: flex; align-items: center; justify-content: center; }
      #browser-frame { width: 100%; height: 100%; border: none; background: white; display: none; }
      #browserContainer h1 { font-size: 1.9rem; margin-bottom: 13px; text-shadow: 0 0 10px rgba(0, 0, 0, 0.8); transition: transform 0.3s ease; }
      #browserContainer h1:hover { transform: scale(1.1); }
      .time-date { font-size: 0.8rem; margin-bottom: 13px; text-shadow: 0 0 10px rgba(0, 0, 0, 0.8); transition: transform 0.3s ease; }
      .time-date:hover { transform: scale(1.1); }
      .search-container { width: 85%; max-width: 600px; margin: 0 auto 1px; }
      .input { font-family: "Futura", sans-serif; width: 85%; padding: 15px; border: none; border-radius: 15px; font-size: 0.93rem; backdrop-filter: blur(10px) !important; -webkit-backdrop-filter: blur(10px) !important; background: rgba(255, 255, 255, 0.2); color: white; box-shadow: 0 3px 13px rgba(0, 0, 0, 0.3); transition: background 0.3s ease, box-shadow 0.3s ease; }
      .input::placeholder { color: rgba(255, 255, 255, 0.7); font-family: "Futura", sans-serif; }
      .input:hover { background: rgba(255, 255, 255, 0.3); box-shadow: 0 3px 13px rgba(0, 0, 0, 0.4); }
      .bookmark, .add-bookmark { margin-bottom: 2px; display: flex; flex-direction: column; align-items: center; padding: 13px; border-radius: 17px; font-size: 10px; width: 85px; height: 85px; background: rgba(255, 255, 255, 0.2); box-shadow: 0 3px 13px rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px) !important; -webkit-backdrop-filter: blur(10px) !important; transition: transform 0.3s ease, background 0.3s ease; }
      .bookmark { text-decoration: none; color: white; backdrop-filter: blur(10px) !important; -webkit-backdrop-filter: blur(10px) !important; }
      .bookmark img { margin: auto; height: 30px; width: auto; transition: transform 0.3s ease; }
      .bookmark span { font-size: 10px; margin: auto; }
      .bookmark:hover, .add-bookmark:hover { transform: scale(1.07); background: rgba(255, 255, 255, 0.3); }
      .bookmark img:hover { transform: rotate(10deg) scale(1.15); }
      .add-bookmark-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 21px; background: rgba(0, 0, 0, 0.9); border-radius: 17px; color: white; display: none; flex-direction: column; gap: 13px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6); width: 298px; }
      .add-bookmark-modal input { padding: 10px 15px; border-radius: 7px; border: none; width: 100%; box-sizing: border-box; font-size: 14px; }
      .add-bookmark-modal button { padding: 10px; border: none; border-radius: 7px; background: #5192f5; color: white; cursor: pointer; transition: background 0.3s ease; font-size: 14px; }
      .add-bookmark-modal button:hover { background: #3e81e6; }
      .top-right-menu, .top-left-menu { position: absolute; top: 13px; }
      .top-right-menu { right: 13px; }
      .top-left-menu { left: 13px; }
      .menu-button { padding: 9px; background: rgba(255, 255, 255, 0.2); color: white; border-radius: 30px; cursor: pointer; font-family: "Futura", sans-serif; font-size: 10px; box-shadow: 0 3px 13px rgba(0, 0, 0, 0.3); transition: all 0.3s ease; }
      .menu-button:hover { background: rgba(255, 255, 255, 0.3); transform: scale(1.1); }
      .rotating-text { font-family: "Futura", sans-serif; font-size: 15px; color: white; text-shadow: 0 0 10px rgba(0, 0, 0, 0.8); margin-top: 13px; min-height: 2em; }
      @keyframes enterBookmarks { to { opacity: 3; } }
    </style>
  </head>
  <body>
    <div id="browser">
      <div id="tabs-bar">
        <div id="tabs-container"></div>
        <button id="new-tab" class="control-btn"><i class="fas fa-plus"></i></button>
      </div>
      <div id="toolbar">
        <div id="controls">
          <button id="back" class="control-btn"><i class="fas fa-arrow-left"></i></button>
          <button id="forward" class="control-btn"><i class="fas fa-arrow-right"></i></button>
          <button id="reload" class="control-btn"><i class="fas fa-sync-alt"></i></button>
        </div>
        <div id="url-bar">
          <input type="text" id="url-input" placeholder="Enter URL..." />
          <button id="go" class="control-btn"><i class="fas fa-paper-plane"></i></button>
        </div>
      </div>
      <div id="content-container">
        <div id="newtab-content">
          <div class="top-right-menu">
            <button class="menu-button" onclick="SHS()">Search History Spammer</button>
          </div>
          <div class="top-left-menu">
            <button class="menu-button" onclick="AB()">About:blank Cloaker</button>
          </div>
          <div id="browserContainer">
            <div id="content">
              <h1>MadEgg Proxy</h1>
              <div class="time-date" id="time-date"></div>
              <div class="search-container">
                <input type="text" class="input" placeholder="Enter a search query or URL" id="searchInputNewtab" />
              </div>
              <div class="bookmarks" id="bookmarks">
                <a href="javascript:void(0)" class="bookmark" onclick="go('https://www.youtube.com')">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/e/ef/Youtube_logo.png" alt="YouTube" />
                  <span>YouTube</span>
                </a>
                <a href="javascript:void(0)" class="bookmark" onclick="go('https://twitter.com')">
                  <img src="https://cdn.freebiesupply.com/logos/large/2x/twitter-3-logo-png-transparent.png" alt="Twitter" />
                  <span>Twitter</span>
                </a>
                <a href="javascript:void(0)" class="bookmark" onclick="go('https://discord.com')">
                  <img src="https://cdn.prod.website-files.com/6257adef93867e50d84d30e2/636e0a6a49cf127bf92de1e2_icon_clyde_blurple_RGB.png" alt="Discord" />
                  <span>Discord</span>
                </a>
                <a href="javascript:void(0)" class="bookmark" onclick="go('https://www.nvidia.com/en-us/geforce-now/')">
                  <img src="https://www.nesabamedia.com/wp-content/uploads/2022/06/GeForce-NOW-Logo-1.png" alt="GeForce Now" />
                  <span>GeForce Now</span>
                </a>
                <div class="add-bookmark" id="add-bookmark">+ Add Bookmark</div>
              </div>
              <div class="rotating-text" id="rotating-text"></div>
              <div class="add-bookmark-modal" id="add-bookmark-modal">
                <input type="text" id="bookmark-name" placeholder="Bookmark Name" />
                <input type="text" id="bookmark-url" placeholder="Bookmark URL" />
                <button id="save-bookmark">Save</button>
              </div>
            </div>
          </div>
        </div>
        <iframe id="browser-frame"></iframe>
      </div>
    </div>
    <div id="settings-page"></div>
    <div id="history-page"></div>
    <script src="./uv/uv.bundle.js"></script>
    <script src="./uv/uv.config.js"></script>
    <script src="./assets/register-sw.js"></script>
    <script src="./assets/script.js"></script>
    <script>
      let searchEngine = "https://www.google.com/search?q=";
      const internalPages = [
        { url: "madegg://newtab", divId: "newtab-content" },
        { url: "madegg://settings", divId: "settings-page" },
        { url: "madegg://history", divId: "history-page" }
      ];
      function hideInternalPages() {
        internalPages.forEach(p => { let d = document.getElementById(p.divId); if(d) d.style.display = "none"; });
        let err = document.getElementById("error-page"); if(err) err.style.display = "none";
      }
      function showInternalPage(url) {
        hideInternalPages();
        let page = internalPages.find(p => p.url === url);
        if(page) {
          let d = document.getElementById(page.divId);
          if(!d && url==="madegg://settings") {
            d = document.createElement("div");
            d.id = "settings-page";
            d.innerHTML = "<h2>Settings</h2><label>Search Engine URL:</label><br/><input type='text' id='search-engine' value='"+searchEngine+"' style='padding:10px; margin:10px;'/><br/><button onclick='updateSearchEngine()' style='padding:10px 15px;'>Update</button>";
            d.style.width = "100%"; d.style.height = "100%"; d.style.display = "flex"; d.style.flexDirection = "column"; d.style.alignItems = "center"; d.style.justifyContent = "center"; d.style.background = "#333"; d.style.color = "white";
            document.getElementById("content-container").appendChild(d);
          }
          if(!d && url==="madegg://history") {
            d = document.createElement("div");
            d.id = "history-page";
            d.style.width = "100%"; d.style.height = "100%"; d.style.background = "#222"; d.style.color = "white"; d.style.padding = "20px"; d.style.overflowY = "auto";
            d.innerHTML = "<h2>History</h2><ul class='history-list' id='history-list'></ul>";
            document.getElementById("content-container").appendChild(d);
          }
          if(d) {
            d.style.display = "block";
            document.getElementById("url-input").value = url;
            document.documentElement.style.overflow = "hidden";
            document.body.style.overflow = "hidden";
          }
        } else {
          let err = document.getElementById("error-page");
          if(!err) { err = document.createElement("div"); err.id = "error-page"; err.style.width = "100%"; err.style.height = "100%"; err.style.display = "flex"; err.style.alignItems = "center"; err.style.justifyContent = "center"; err.style.background = "#900"; err.style.color = "white"; err.innerHTML = "<h2>Error: Page not found</h2>"; document.getElementById("content-container").appendChild(err); }
          err.style.display = "flex";
          document.getElementById("url-input").value = url;
          document.documentElement.style.overflow = "hidden";
          document.body.style.overflow = "hidden";
        }
      }
      function updateSearchEngine() {
        const newSE = document.getElementById("search-engine").value.trim();
        if(newSE) { searchEngine = newSE; alert("Search engine updated."); }
      }
      function go(url) {
        const newtabContent = document.getElementById("newtab-content");
        const browserFrame = document.getElementById("browser-frame");
        const urlInput = document.getElementById("url-input");
        hideInternalPages();
        if(url.indexOf("madegg://") === 0) {
          showInternalPage(url);
          return;
        }
        if (!/^https?:\/\//i.test(url)) {
          if(url.indexOf(" ") !== -1 || !url.includes(".")) { url = searchEngine + encodeURIComponent(url); }
          else { url = "https://" + url; }
        }
        newtabContent.style.display = "none";
        internalPages.forEach(p => { let d = document.getElementById(p.divId); if(d) d.style.display = "none"; });
        let err = document.getElementById("error-page"); if(err) err.style.display = "none";
        browserFrame.style.display = "block";
        const processedUrl = "https://asphalt-nine.vercel.app/" + __uv$config.prefix + __uv$config.encodeUrl(url);
        browserFrame.src = processedUrl;
        urlInput.value = url;
        document.documentElement.style.overflow = "auto";
        document.body.style.overflow = "auto";
      }
      class Browser {
        constructor() {
          this.tabs = [];
          this.activeTabId = null;
          this.initElements();
          this.bindEvents();
          this.createTab();
        }
        initElements() {
          this.tabsContainer = document.getElementById("tabs-container");
          this.contentContainer = document.getElementById("content-container");
          this.urlInput = document.getElementById("url-input");
          this.backBtn = document.getElementById("back");
          this.forwardBtn = document.getElementById("forward");
          this.reloadBtn = document.getElementById("reload");
          this.goBtn = document.getElementById("go");
          this.newTabBtn = document.getElementById("new-tab");
          this.newtabContent = document.getElementById("newtab-content");
          this.browserFrame = document.getElementById("browser-frame");
        }
        bindEvents() {
          this.backBtn.addEventListener("click", () => this.goBack());
          this.forwardBtn.addEventListener("click", () => this.goForward());
          this.reloadBtn.addEventListener("click", () => this.reload());
          this.goBtn.addEventListener("click", () => this.navigate());
          this.newTabBtn.addEventListener("click", () => this.createTab());
          this.urlInput.addEventListener("keypress", (e) => { if (e.key === "Enter") this.navigate(); });
        }
        createTab() {
          const tabId = Date.now();
          this.tabs.push({ id: tabId, url: "madegg://newtab", history: ["madegg://newtab"], historyIndex: 0 });
          this.renderTabs();
          this.setActiveTab(tabId);
        }
        setActiveTab(tabId) {
          this.activeTabId = tabId;
          const tab = this.tabs.find(t => t.id === tabId);
          this.urlInput.value = tab.url;
          this.renderTabs();
          this.renderContent(tab);
        }
        renderTabs() {
          this.tabsContainer.innerHTML = this.tabs.map(tab =>
            '<div class="tab ' + (tab.id === this.activeTabId ? "active" : "") + '" data-tab-id="' + tab.id + '">' +
            (tab.url === "madegg://newtab" ? "New Tab" : tab.url) +
            '<span class="close-tab" onclick="browser.closeTab(' + tab.id + ')"><i class="fas fa-times"></i></span></div>'
          ).join("");
          document.querySelectorAll(".tab").forEach(tabEl => {
            tabEl.addEventListener("click", e => { if (!e.target.classList.contains("close-tab")) { this.setActiveTab(parseInt(tabEl.dataset.tabId)); } });
          });
        }
        renderContent(tab) {
          this.browserFrame.style.display = "none";
          this.newtabContent.style.display = "none";
          internalPages.forEach(p => { let d = document.getElementById(p.divId); if(d) d.style.display = "none"; });
          let err = document.getElementById("error-page"); if(err) err.style.display = "none";
          if (tab.url === "madegg://newtab") { this.newtabContent.style.display = "block"; }
          else { this.browserFrame.style.display = "block"; this.browserFrame.src = "https://asphalt-nine.vercel.app/" + __uv$config.prefix + __uv$config.encodeUrl(tab.url); }
        }
        navigate() {
          const input = this.urlInput.value.trim();
          let finalUrl = input;
          if (input === "madegg://newtab") { finalUrl = input; }
          else {
            try { new URL(input); }
            catch (_) {
              if(input.indexOf(" ") !== -1 || !input.includes(".")) { finalUrl = searchEngine + encodeURIComponent(input); }
              else { finalUrl = "https://" + input; }
            }
          }
          if(finalUrl.indexOf("madegg://") !== 0) {
            const tab = this.tabs.find(t => t.id === this.activeTabId);
            tab.history = tab.history.slice(0, tab.historyIndex + 1);
            tab.history.push(finalUrl);
            tab.historyIndex = tab.history.length - 1;
          }
          go(finalUrl);
        }
        goBack() {
          const tab = this.tabs.find(t => t.id === this.activeTabId);
          if (tab.historyIndex > 0) {
            tab.historyIndex--;
            const url = tab.history[tab.historyIndex];
            this.urlInput.value = url;
            go(url);
          }
        }
        goForward() {
          const tab = this.tabs.find(t => t.id === this.activeTabId);
          if (tab.historyIndex < tab.history.length - 1) {
            tab.historyIndex++;
            const url = tab.history[tab.historyIndex];
            this.urlInput.value = url;
            go(url);
          }
        }
        reload() {
          const tab = this.tabs.find(t => t.id === this.activeTabId);
          if (tab) this.renderContent(tab);
        }
        closeTab(tabId) {
          this.tabs = this.tabs.filter(t => t.id !== tabId);
          this.renderTabs();
          if (this.tabs.length === 0) this.createTab();
        }
      }
      const browser = new Browser();
      document.getElementById("searchInputNewtab").addEventListener("keypress", e => {
        if (e.key === "Enter") { e.preventDefault(); const input = e.target.value.trim(); document.getElementById("url-input").value = input; go(input); }
      });
      const addBookmarkButton = document.getElementById("add-bookmark");
      const addBookmarkModal = document.getElementById("add-bookmark-modal");
      const saveBookmarkButton = document.getElementById("save-bookmark");
      const bookmarksContainer = document.getElementById("bookmarks");
      addBookmarkButton.addEventListener("click", () => { addBookmarkModal.style.display = "flex"; });
      saveBookmarkButton.addEventListener("click", () => {
        const name = document.getElementById("bookmark-name").value;
        const url = document.getElementById("bookmark-url").value;
        if(name && url) {
          const link = document.createElement("a");
          link.href = "#";
          link.className = "bookmark";
          const img = document.createElement("img");
          img.src = "https://www.google.com/s2/favicons?sz=64&domain_url=" + encodeURIComponent(url);
          img.alt = name;
          link.appendChild(img);
          const span = document.createElement("span");
          span.textContent = name;
          link.appendChild(span);
          link.addEventListener("click", () => { go(url); });
          bookmarksContainer.insertBefore(link, addBookmarkButton);
          addBookmarkModal.style.display = "none";
        }
      });
      function updateTimeDate() {
        const date = new Date();
        const options = { weekday: "long", year: "numeric", month: "long", day: "numeric", hour: "2-digit", minute: "2-digit", second: "2-digit" };
        document.getElementById("time-date").textContent = date.toLocaleDateString("en-US", options).replace(" at", ",");
      }
      setInterval(updateTimeDate, 1000);
      updateTimeDate();
      function updateHistoryPage() {
        const historyDiv = document.getElementById("history-page");
        if(historyDiv) {
          let currentTab = browser.tabs.find(t => t.id === browser.activeTabId);
          let html = "<h2>History</h2><ul class='history-list'>";
          currentTab.history.forEach(item => { html += "<li onclick='go(\"" + item + "\")'>" + item + "</li>"; });
          html += "</ul>";
          historyDiv.innerHTML = html;
        }
      }
    </script>
  </body>
</html>
